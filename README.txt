I am using option 3, FSA table + driver.
The FSA table is in the file FSAtable.h and the driver is in the file scanner.h, using a combination of the scanner, filter, and FSAcolumn functions.

P1 Scanner CS4280
Liora Wachsstock

